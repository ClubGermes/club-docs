# üîê –ú–µ–Ω–µ–¥–∂–µ—Ä: –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (Login)

**–ö–æ–¥:** [`Login.svelte`](../../../frontend/club-manager/src/views/Login.svelte)  
**–†–æ—É—Ç:** `/auth` (Layout: `Auth`)

## 1. –û–±—â–µ–µ –æ–ø–∏—Å–∞–Ω–∏–µ
–≠–∫—Ä–∞–Ω –≤—Ö–æ–¥–∞ –≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—É—é –ø–∞–Ω–µ–ª—å "Community Manager". –ü—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –∫–æ–º–ø–∞–∫—Ç–Ω—É—é –∫–∞—Ä—Ç–æ—á–∫—É —Å —Ç—Ä–µ–º—è —Å–ø–æ—Å–æ–±–∞–º–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏. –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –∫–∞–∫ SPA-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Å –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π –Ω–∞–≤–∏–≥–∞—Ü–∏–µ–π (—Ç–∞–±–∞–º–∏) –±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã.

---

## 2. –°–ø–æ—Å–æ–±—ã –≤—Ö–æ–¥–∞

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç —Ä–µ–∂–∏–º—ã —Å –ø–æ–º–æ—â—å—é —Ç–∞–±–æ–≤ –≤ –≤–µ—Ä—Ö–Ω–µ–π —á–∞—Å—Ç–∏ –∫–∞—Ä—Ç–æ—á–∫–∏. –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –æ—á–∏—â–∞–µ—Ç –≤–≤–µ–¥–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ.

> **–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–π**
> 
> | SMS (OTP) | Email (OTP) | –ü–∞—Ä–æ–ª—å |
> | :---: | :---: | :---: |
> | ![SMS](../images/manager/auth/login-sms.png) | ![Email](../images/manager/auth/login-email.png) | ![Password](../images/manager/auth/login-password.png) |

### üì± –†–µ–∂–∏–º 1: SMS (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
*   **–°—Ü–µ–Ω–∞—Ä–∏–π:** –í—Ö–æ–¥ –ø–æ –Ω–æ–º–µ—Ä—É —Ç–µ–ª–µ—Ñ–æ–Ω–∞ —á–µ—Ä–µ–∑ –æ–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–π –∫–æ–¥.
*   **–ü–æ–ª—è:**
    *   `–¢–µ–ª–µ—Ñ–æ–Ω`: –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ RegEx `[\d\s\(\)\-]{10,20}`.
    *   `–ö–æ–¥`: –ü–æ–ª–µ –≤–≤–æ–¥–∞ –∫–æ–¥–∞ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –∏ –∫–Ω–æ–ø–∫–∞ –º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ "–í–æ–π—Ç–∏" –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ –∫–æ–¥.
*   **–î–µ–π—Å—Ç–≤–∏–µ:**
    1.  –í–≤–æ–¥ —Ç–µ–ª–µ—Ñ–æ–Ω–∞ -> –ö–Ω–æ–ø–∫–∞ "–ü–æ–ª—É—á–∏—Ç—å –∫–æ–¥" (`userSetCode`).
    2.  –í–≤–æ–¥ –∫–æ–¥–∞ -> –ö–Ω–æ–ø–∫–∞ "–í–æ–π—Ç–∏" (`userValidateCode`).

### üìß –†–µ–∂–∏–º 2: Email
*   **–°—Ü–µ–Ω–∞—Ä–∏–π:** –í—Ö–æ–¥ –ø–æ –ø–æ—á—Ç–µ —á–µ—Ä–µ–∑ –æ–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–π –∫–æ–¥.
*   **–ü–æ–ª—è:**
    *   `Email`: –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–º—É RegEx.
*   **–î–µ–π—Å—Ç–≤–∏–µ:** –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ SMS, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ—Ç –∂–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç `userSetCode` —Å —Ç–∏–ø–æ–º `email`.

### üîë –†–µ–∂–∏–º 3: –ü–∞—Ä–æ–ª—å
*   **–°—Ü–µ–Ω–∞—Ä–∏–π:** –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –≤—Ö–æ–¥ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤.
*   **–ü–æ–ª—è:**
    *   `Email / –¢–µ–ª–µ—Ñ–æ–Ω`: –ï–¥–∏–Ω–æ–µ –ø–æ–ª–µ –≤–≤–æ–¥–∞ –ª–æ–≥–∏–Ω–∞.
    *   `–ü–∞—Ä–æ–ª—å`: –°–∫—Ä—ã—Ç–æ–µ –ø–æ–ª–µ –≤–≤–æ–¥–∞.
*   **–î–µ–π—Å—Ç–≤–∏–µ:** –ö–Ω–æ–ø–∫–∞ "–í–æ–π—Ç–∏" –≤—ã–∑—ã–≤–∞–µ—Ç `userLogin`.

---

## 3. –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

### UI –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
*   **–°–ª–∞–π–¥–µ—Ä —Ñ–æ—Ä–º:** –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω —á–µ—Ä–µ–∑ CSS-—Ç—Ä–∞–Ω–∑–∏—à–Ω—ã. –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä `div` –∏–º–µ–µ—Ç —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—É—é —à–∏—Ä–∏–Ω—É, –∞ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –±–ª–æ–∫ `w-[300%]` —Å–¥–≤–∏–≥–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `margin-left` (`ml-0`, `ml-[-100%]`, `ml-[-200%]`) –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π `step` (1, 2, 3).
*   **–ö–Ω–æ–ø–∫–∞ "–í–æ–π—Ç–∏":** –í—ã–Ω–µ—Å–µ–Ω–∞ –≤–∏–∑—É–∞–ª—å–Ω–æ –∑–∞ –ø—Ä–µ–¥–µ–ª—ã –∫–∞—Ä—Ç–æ—á–∫–∏ (—Å–Ω–∏–∑—É) —Å –ø–æ–º–æ—â—å—é –∫–ª–∞—Å—Å–∞ `indicator-item`. –û–Ω–∞ –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è (`disabled={!valid}`) —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ –ø—Ä–æ–π–¥–µ–Ω—ã –≤—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ.

### –õ–æ–≥–∏–∫–∞ (`Login.svelte`)

*   **State:**
    *   `step`: –¢–µ–∫—É—â–∞—è –≤–∫–ª–∞–¥–∫–∞ (1 - SMS, 2 - Email, 3 - –ü–∞—Ä–æ–ª—å).
    *   `code`: –§–ª–∞–≥, –ø–æ–∫–∞–∑—ã–≤–∞—é—â–∏–π, —á—Ç–æ –∫–æ–¥ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –∏ –Ω—É–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å –ø–æ–ª–µ –¥–ª—è –≤–≤–æ–¥–∞ OTP.
    *   `waitFlag`: –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ –∫–æ–¥–∞ –Ω–∞ 10 —Å–µ–∫—É–Ω–¥.

### API Queries (`src/queries/auth.ts`)

| –ú–µ—Ç–æ–¥ | Query | –û–ø–∏—Å–∞–Ω–∏–µ |
| :--- | :--- | :--- |
| **–û—Ç–ø—Ä–∞–≤–∫–∞ –∫–æ–¥–∞** | `userSetCode` | `POST /login/{type}`. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç OTP. |
| **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞** | `userValidateCode` | `POST /man/login/{type}/validate`. –û–±–º–µ–Ω–∏–≤–∞–µ—Ç OTP –Ω–∞ —Ç–æ–∫–µ–Ω. |
| **–í—Ö–æ–¥ –ø–æ –ø–∞—Ä–æ–ª—é** | `userLogin` | `POST /man/login`. –û–±–º–µ–Ω–∏–≤–∞–µ—Ç –ø–∞—Ä—É –ª–æ–≥–∏–Ω/–ø–∞—Ä–æ–ª—å –Ω–∞ —Ç–æ–∫–µ–Ω. |

---

## 4. –í–∞–ª–∏–¥–∞—Ü–∏—è
–ö–Ω–æ–ø–∫–∞ "–í–æ–π—Ç–∏" –∏ "–ü–æ–ª—É—á–∏—Ç—å –∫–æ–¥" –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è –∞—Ç—Ä–∏–±—É—Ç–æ–º `disabled` –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö:
*   `validPhone`: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞.
*   `validEmail`: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞ –ø–æ—á—Ç—ã.
*   `valid`: –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —É—Å–ª–æ–≤–∏–µ (–≤—ã–±—Ä–∞–Ω–Ω—ã–π —à–∞–≥ + –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ—Å—Ç—å –ø–æ–ª–µ–π + –¥–ª–∏–Ω–∞ –∫–æ–¥–∞ = 4 —Å–∏–º–≤–æ–ª–∞).