# Быстрый старт

Это руководство поможет вам развернуть проект `club-platform` локально за 5–10 минут.

## Требования

Перед началом убедитесь, что у вас установлены:
*   **Docker** и **Docker Compose**
*   **Python 3.10+** (рекомендуется 3.12)
*   **Make** (обычно предустановлен на macOS/Linux)
*   **Node.js** (для фронтенда)

## 1. Установка зависимостей

В корне проекта выполните команду для настройки инструментов разработки и виртуальных окружений:

```bash
make install-tools
```

> **Что происходит:**
> 1. Создается локальное окружение `.venv` для утилиты `honcho`.
> 2. Запускается скрипт `backend/setup-all.sh`.
> 3. Для каждого микросервиса в `backend/apps/` создается отдельный `venv` и устанавливаются зависимости из `requirements.txt`.

## 2. Запуск проекта

Для запуска используйте команду:

```bash
make dev
```

Эта команда:
1.  Поднимает инфраструктуру в Docker (Postgres на порту `5433`, Redis на `6379`).
2.  Запускает все микросервисы через `honcho` (Procfile).
3.  Включает режим `reload` — изменения в коде автоматически перезагружают сервисы.

> **Важно:**
> Если вы видите ошибки `bad interpreter` или `command not found`, попробуйте удалить папки `venv` внутри сервисов и запустить `make install-tools` заново.

## 3. Остановка

Чтобы корректно остановить всё:
1.  Нажмите `Ctrl + C` в терминале, где запущен `make dev`.
2.  Выполните команду для очистки контейнеров:

```bash
make down
```

## Troubleshooting (Решение проблем)

### Конфликт портов
Если при запуске вы видите ошибку `Address already in use`:
*   Проверьте, не запущен ли у вас локальный PostgreSQL на порту `5432`.
*   Docker Compose настроен мапить порт контейнера на **`5433`** (`5433:5432`), чтобы избежать конфликтов.
*   Убедитесь, что ваше приложение подключается именно к `5433`.

### Ошибки SSL подключения к БД
В логах может быть ошибка: `sslmode value "require" invalid when SSL support is not compiled in`.
*   **Локально:** SSL обычно отключен. Проверьте конфиг `pg.toml` или `.env`.
*   **Продакшн:** Managed PostgreSQL (Yandex/AWS) требует `sslmode=require`.

### Ошибки Redis
Если сервисы падают с ошибкой подключения к Redis:
*   Убедитесь, что контейнер `club-platform-redis-1` запущен (`docker ps`).
*   Проверьте хост Redis в конфиге: локально это `localhost`, внутри Docker-сети — `redis`.

## Полезные команды

| Команда | Описание |
|---------|----------|
| `make logs` | Просмотр логов всех контейнеров |
| `make clean` | Полная очистка (удаляет контейнеры и тома данных!) |
| `make ps` | Показать статус запущенных сервисов |
