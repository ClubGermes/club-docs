# üìÖ –†–∞–∑–¥–µ–ª ¬´–°–æ–±—ã—Ç–∏—è¬ª (Events)

**–§–∞–π–ª:** `src/views/Events/Events.svelte`
**–ú–∞—Ä—à—Ä—É—Ç:** `/events`

–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π —Ä–∞–∑–¥–µ–ª –¥–ª—è –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —É—á–∞—Å—Ç–∏—è –≤ –∂–∏–∑–Ω–∏ –ö–ª—É–±–∞. –°–æ—á–µ—Ç–∞–µ—Ç –≤ —Å–µ–±–µ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å –∏ –±–µ—Å–∫–æ–Ω–µ—á–Ω—É—é –ª–µ–Ω—Ç—É –ø—Ä–µ–¥—Å—Ç–æ—è—â–∏—Ö –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏.

| –°–ø–∏—Å–æ–∫ —Å–æ–±—ã—Ç–∏–π | –†–∞–∑–≤–µ—Ä–Ω—É—Ç—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å |
|---|---|
| ![Events List](events-calendar-off.png) { width="300" } | ![Full Calendar](events-calendar-on.png) { width="300" } |

## 1. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞

–≠–∫—Ä–∞–Ω —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –∫–∞–∫ —Å–ª–æ–∂–Ω—ã–π –≥–∏–±—Ä–∏–¥–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º **CupertinoPane** –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –∫–∞–ª–µ–Ω–¥–∞—Ä—è.

### A. –í–µ—Ä—Ö–Ω—è—è –ø–∞–Ω–µ–ª—å (Header)
*   **–ù–∞–≤–∏–≥–∞—Ü–∏—è:** –ö–Ω–æ–ø–∫–∞ ¬´–ù–∞–∑–∞–¥¬ª (–µ—Å–ª–∏ –ø–µ—Ä–µ—Ö–æ–¥ –±—ã–ª –Ω–µ –∏–∑ —Ç–∞–±-–±–∞—Ä–∞).
*   **–ó–∞–≥–æ–ª–æ–≤–æ–∫:** ¬´–°–æ–±—ã—Ç–∏—è¬ª.
*   **–§–∏–ª—å—Ç—Ä—ã:** –ö–Ω–æ–ø–∫–∞ —Å–ø—Ä–∞–≤–∞ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–∫ (`src/views/Events/components/Filters/index.svelte`).
    *   *–ò–Ω–¥–∏–∫–∞—Ü–∏—è:* –ë–µ–π–¥–∂ —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤ (`activeEventsFiltersAmount`).
    *   *–û–ø—Ü–∏–∏:*
        1.  **–ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –∫–∞–ª–µ–Ω–¥–∞—Ä—å:** –ü–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç —Ä–µ–∂–∏–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø—Ä–∏ –≤—Ö–æ–¥–µ.
        2.  **–ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –±–ª–∏–∂–∞–π—à–∏–µ:** –í–∫–ª—é—á–∞–µ—Ç/–æ—Ç–∫–ª—é—á–∞–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–æ—à–µ–¥—à–∏—Ö —Å–æ–±—ã—Ç–∏–π (–ø–∞—Ä–∞–º–µ—Ç—Ä `future` –≤ —Å—Ç–æ—Ä–µ).

### B. –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –ö–∞–ª–µ–Ω–¥–∞—Ä—å
–ö–∞–ª–µ–Ω–¥–∞—Ä—å –∏–º–µ–µ—Ç –¥–≤–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è, –ø–µ—Ä–µ–∫–ª—é—á–∞–µ–º—ã—Ö —Å–≤–∞–π–ø–æ–º –∏–ª–∏ –∫–ª–∏–∫–æ–º:

1.  **–°–ª–∞–π–¥–µ—Ä (Collapsed):**
    *   **–ö–æ–º–ø–æ–Ω–µ–Ω—Ç:** `CalendarSlider`.
    *   –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è –ª–µ–Ω—Ç–∞ –¥–∞—Ç (Swiper).
    *   *–ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã:* –¶–≤–µ—Ç–Ω—ã–µ —Ç–æ—á–∫–∏ –ø–æ–¥ –¥–∞—Ç–∞–º–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –Ω–∞–ª–∏—á–∏–µ —Å–æ–±—ã—Ç–∏–π –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö —Ç–∏–ø–æ–≤ (—Ü–≤–µ—Ç–∞ –∏–∑ `events.cfg.ts`).
2.  **–°–µ—Ç–∫–∞ –º–µ—Å—è—Ü–∞ (Expanded):**
    *   **–ö–æ–º–ø–æ–Ω–µ–Ω—Ç:** `Calendar`.
    *   –ù–∞—Ö–æ–¥–∏—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ `CupertinoPane` (—à—Ç–æ—Ä–∫–∞ —Å–≤–µ—Ä—Ö—É).
    *   –ü–æ–∑–≤–æ–ª—è–µ—Ç –±—ã—Å—Ç—Ä–æ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å—Å—è –º–µ–∂–¥—É –º–µ—Å—è—Ü–∞–º–∏ –∏ –≤—ã–±–∏—Ä–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –¥–∞—Ç—É.
    *   *UX:* –ü—Ä–∏ –≤—ã–±–æ—Ä–µ –¥–∞—Ç—ã —à—Ç–æ—Ä–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç—Å—è, –æ–±–Ω–æ–≤–ª—è—è —Å–ø–∏—Å–æ–∫ –≤–Ω–∏–∑—É.

### C. –õ–µ–Ω—Ç–∞ —Å–æ–±—ã—Ç–∏–π
*   **–ö–æ–º–ø–æ–Ω–µ–Ω—Ç:** `EventCard`.
*   **–ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞:** –°–æ–±—ã—Ç–∏—è –≥—Ä—É–ø–ø–∏—Ä—É—é—Ç—Å—è –ø–æ –¥–∞—Ç–∞–º. –ï—Å–ª–∏ –∞–∫—Ç–∏–≤–µ–Ω —Ñ–∏–ª—å—Ç—Ä "–ë—É–¥—É—â–∏–µ", –≤ —Å–ø–∏—Å–∫–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å "–ë–ª–∏–∂–∞–π—à–∏–µ —Å–æ–±—ã—Ç–∏—è" (–≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π ID `-1`).
*   **–ê–Ω–∏–º–∞—Ü–∏—è:** –ü–ª–∞–≤–Ω–æ–µ –ø–æ—è–≤–ª–µ–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–µ–∫ (`fade`) –ø—Ä–∏ —Å–º–µ–Ω–µ –¥–∞—Ç—ã –∏–ª–∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤.

---

## 2. –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

### Data Flow & Caching
–õ–æ–≥–∏–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –¥–ª—è –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤:

*   **Query:** `eventsFeed` (`src/queries/event.ts`).
*   **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:** –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç—Å—è –¥–∏–∞–ø–∞–∑–æ–Ω –¥–∞—Ç (`from`, `to`), —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –≤–∏–¥–∏–º–æ–º—É –≤ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ –º–µ—Å—è—Ü—É.
*   **Local Cache:** –ü–æ–ª—É—á–µ–Ω–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ª–æ–∫–∞–ª—å–Ω—ã–π –æ–±—ä–µ–∫—Ç `events` —Å –∫–ª—é—á–æ–º –≤–∏–¥–∞ `YYYYMMDD`. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –º–≥–Ω–æ–≤–µ–Ω–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ –¥–∞—Ç –±–µ–∑ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ API.
*   **Entity:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–∞—Ç—Ç–µ—Ä–Ω `Entity` –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –∑–∞–≥—Ä—É–∑–∫–∏ (`eventsFeedHandler.loading`).

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (`src/config/events.cfg.ts`)
–í–Ω–µ—à–Ω–∏–π –≤–∏–¥ (–∏–∫–æ–Ω–∫–∏, —Ü–≤–µ—Ç–∞) –ø–æ–ª–Ω–æ—Å—Ç—å—é —É–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –∫–æ–Ω—Ñ–∏–≥–æ–º, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã –±–µ–∑ –ø—Ä–∞–≤–∫–∏ –≤–µ—Ä—Å—Ç–∫–∏.

```typescript
// –ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Ñ–æ—Ä–º–∞—Ç–∞
{
    format: 'tender',
    name: '–¢–µ–Ω–¥–µ—Ä–Ω—ã–π —Ä–∞–∑–±–æ—Ä',
    color: 'primary brightness-90', // –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è utility-–∫–ª–∞—Å—Å—ã
    icon: '<svg...>' // –í–µ–∫—Ç–æ—Ä–Ω–∞—è –∏–∫–æ–Ω–∫–∞
}
```

---

## 3. –ö–ª—é—á–µ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
| :--- | :--- |
| **Calendar** | –ü–æ–ª–Ω–∞—è —Å–µ—Ç–∫–∞ –º–µ—Å—è—Ü–∞. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –º–∞—Å—Å–∏–≤ –¥–∞—Ç (`createCalendarRange`). –£–ø—Ä–∞–≤–ª—è–µ—Ç –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ–º –º–µ—Å—è—Ü–µ–≤. |
| **CalendarSlider** | –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–π —Å–≤–∞–π–ø–µ—Ä. –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è —Å –æ—Å–Ω–æ–≤–Ω—ã–º –∫–∞–ª–µ–Ω–¥–∞—Ä–µ–º (`sync` flag). |
| **EventCard** | –ö–∞—Ä—Ç–æ—á–∫–∞ —Å–æ–±—ã—Ç–∏—è. –°–æ–¥–µ—Ä–∂–∏—Ç —Ñ–æ–ª–ª–±—ç–∫ –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (`handleBgImageError`) ‚Äî –µ—Å–ª–∏ –æ–±–ª–æ–∂–∫–∞ –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª–∞—Å—å, —Å—Ç–∞–≤–∏—Ç—Å—è –¥–µ—Ñ–æ–ª—Ç–Ω–∞—è. |
| **CupertinoPane** | –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –≤ `swiperCreate`. –ù–∞—Å—Ç—Ä–æ–µ–Ω–∞ —Å `inverse: true` (—à—Ç–æ—Ä–∫–∞ —Å–≤–µ—Ä—Ö—É) –∏ `breaks` –¥–ª—è –¥–≤—É—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π –≤—ã—Å–æ—Ç—ã. |

---

## 4. –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ UX

1.  **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–π:** –ò–∑–º–µ–Ω–µ–Ω–∏–µ –¥–∞—Ç—ã –≤ `Calendar` –æ–±–Ω–æ–≤–ª—è–µ—Ç `CalendarSlider` –∏ –Ω–∞–æ–±–æ—Ä–æ—Ç. –°—Ç–æ—Ä `eventsFilters` —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–∞–ª–µ–Ω–¥–∞—Ä—è (–æ—Ç–∫—Ä—ã—Ç/–∑–∞–∫—Ä—ã—Ç) –º–µ–∂–¥—É —Å–µ—Å—Å–∏—è–º–∏.
2.  **–†–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å:** –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —Å–æ–±—ã—Ç–∏–µ `events` (—á–µ—Ä–µ–∑ WebSocket/Push) –≤—ã–∑—ã–≤–∞–µ—Ç `refresh()`, –æ–±–Ω–æ–≤–ª—è—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.
3.  **–û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–∫–æ–≤:** –í —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –∫–∞–ª–µ–Ω–¥–∞—Ä—è –∫–ª–∏–∫–∏ –ø–æ —Å–ø–∏—Å–∫—É —Å–æ–±—ã—Ç–∏–π –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è (`preventClicks: true` –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö —à—Ç–æ—Ä–∫–∏), —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å —Å–ª—É—á–∞–π–Ω—ã—Ö –ø–µ—Ä–µ—Ö–æ–¥–æ–≤.